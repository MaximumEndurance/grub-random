#!/bin/bash

cd /
 
mkdir grubSplashImages
cd grubSplashImages
wget -O default-URL-list https://github.com/MaximumEndurance/grub-random/blob/master/default-URL-list 
wget -i default-URL-list
file="/etc/default/grub"

current_user=$USER

sudo sed -i 's/.*export.*//' $file
sudo sed -i 's/.*grubImage.*//' $file ## safety precaution. If the user runs the script multiple times it would create multiple entries in /etc/default/grub file
command="grubImage=\`ls /grubSplashImages | sort -R | tail -\$N | head -1\` \n
export GRUB_MENU_PICTURE=\"/grubSplashImages/\$grubImage\"  "

## entering commands into /etc/default/grub

sudo echo -e $command >> $file


## Making changes permanent
## So update-grub runs everytime on bootup and a new random image is selected
file2="/etc/rc.local"
sed -i 's/sudo update-grub//' $file2  # removing redundant entires
sudo echo "sudo update-grub" >> /etc/rc.local

sudo update-grub	# update entries in grub for the first time
rm /grubSplashImages/default-URL-list.txt
echo -e "Successfully Configured Changes\n\n"
